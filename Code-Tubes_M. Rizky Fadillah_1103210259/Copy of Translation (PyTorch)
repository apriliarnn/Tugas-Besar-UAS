{"cells":[{"cell_type":"markdown","metadata":{"id":"D1XUJYcMif-k"},"source":["# Translation (PyTorch)"]},{"cell_type":"markdown","metadata":{"id":"K48zcfEVif-m"},"source":["Install the Transformers, Datasets, and Evaluate libraries to run this notebook."]},{"cell_type":"code","execution_count":1,"metadata":{"id":"UB6FoDKDif-m","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1735998069324,"user_tz":-420,"elapsed":39525,"user":{"displayName":"M.Rizky Fadillah","userId":"02911994023466566780"}},"outputId":"2ce0159f-e1eb-497a-cd42-f8f3ab3745d7"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting datasets\n","  Downloading datasets-3.2.0-py3-none-any.whl.metadata (20 kB)\n","Collecting evaluate\n","  Downloading evaluate-0.4.3-py3-none-any.whl.metadata (9.2 kB)\n","Requirement already satisfied: transformers[sentencepiece] in /usr/local/lib/python3.10/dist-packages (4.47.1)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from datasets) (3.16.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.26.4)\n","Requirement already satisfied: pyarrow>=15.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (17.0.0)\n","Collecting dill<0.3.9,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.8-py3-none-any.whl.metadata (10 kB)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (2.2.2)\n","Requirement already satisfied: requests>=2.32.2 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.32.3)\n","Requirement already satisfied: tqdm>=4.66.3 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.67.1)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.5.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (12 kB)\n","Collecting multiprocess<0.70.17 (from datasets)\n","  Downloading multiprocess-0.70.16-py310-none-any.whl.metadata (7.2 kB)\n","Collecting fsspec<=2024.9.0,>=2023.1.0 (from fsspec[http]<=2024.9.0,>=2023.1.0->datasets)\n","  Downloading fsspec-2024.9.0-py3-none-any.whl.metadata (11 kB)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets) (3.11.10)\n","Requirement already satisfied: huggingface-hub>=0.23.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.27.0)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (24.2)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0.2)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers[sentencepiece]) (2024.11.6)\n","Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.10/dist-packages (from transformers[sentencepiece]) (0.21.0)\n","Requirement already satisfied: safetensors>=0.4.1 in /usr/local/lib/python3.10/dist-packages (from transformers[sentencepiece]) (0.4.5)\n","Requirement already satisfied: sentencepiece!=0.1.92,>=0.1.91 in /usr/local/lib/python3.10/dist-packages (from transformers[sentencepiece]) (0.2.0)\n","Requirement already satisfied: protobuf in /usr/local/lib/python3.10/dist-packages (from transformers[sentencepiece]) (4.25.5)\n","Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.4.4)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.2)\n","Requirement already satisfied: async-timeout<6.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (4.0.3)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (24.3.0)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.5.0)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (6.1.0)\n","Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (0.2.1)\n","Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.18.3)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.23.0->datasets) (4.12.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (3.4.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (2.2.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (2024.12.14)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2024.2)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2024.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.17.0)\n","Downloading datasets-3.2.0-py3-none-any.whl (480 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m480.6/480.6 kB\u001b[0m \u001b[31m4.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading evaluate-0.4.3-py3-none-any.whl (84 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m84.0/84.0 kB\u001b[0m \u001b[31m3.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading dill-0.3.8-py3-none-any.whl (116 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m116.3/116.3 kB\u001b[0m \u001b[31m3.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading fsspec-2024.9.0-py3-none-any.whl (179 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m179.3/179.3 kB\u001b[0m \u001b[31m6.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading multiprocess-0.70.16-py310-none-any.whl (134 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m5.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading xxhash-3.5.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (194 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m194.1/194.1 kB\u001b[0m \u001b[31m9.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: xxhash, fsspec, dill, multiprocess, datasets, evaluate\n","  Attempting uninstall: fsspec\n","    Found existing installation: fsspec 2024.10.0\n","    Uninstalling fsspec-2024.10.0:\n","      Successfully uninstalled fsspec-2024.10.0\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","gcsfs 2024.10.0 requires fsspec==2024.10.0, but you have fsspec 2024.9.0 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed datasets-3.2.0 dill-0.3.8 evaluate-0.4.3 fsspec-2024.9.0 multiprocess-0.70.16 xxhash-3.5.0\n","Requirement already satisfied: accelerate in /usr/local/lib/python3.10/dist-packages (1.2.1)\n","Requirement already satisfied: numpy<3.0.0,>=1.17 in /usr/local/lib/python3.10/dist-packages (from accelerate) (1.26.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (24.2)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.10/dist-packages (from accelerate) (6.0.2)\n","Requirement already satisfied: torch>=1.10.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.5.1+cu121)\n","Requirement already satisfied: huggingface-hub>=0.21.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (0.27.0)\n","Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.10/dist-packages (from accelerate) (0.4.5)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.21.0->accelerate) (3.16.1)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.21.0->accelerate) (2024.9.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.21.0->accelerate) (2.32.3)\n","Requirement already satisfied: tqdm>=4.42.1 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.21.0->accelerate) (4.67.1)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.21.0->accelerate) (4.12.2)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (3.4.2)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (3.1.4)\n","Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.10/dist-packages (from torch>=1.10.0->accelerate) (1.13.1)\n","Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy==1.13.1->torch>=1.10.0->accelerate) (1.3.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.10.0->accelerate) (3.0.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub>=0.21.0->accelerate) (3.4.0)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub>=0.21.0->accelerate) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub>=0.21.0->accelerate) (2.2.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->huggingface-hub>=0.21.0->accelerate) (2024.12.14)\n","Reading package lists... Done\n","Building dependency tree... Done\n","Reading state information... Done\n","git-lfs is already the newest version (3.0.2-1ubuntu0.3).\n","0 upgraded, 0 newly installed, 0 to remove and 49 not upgraded.\n"]}],"source":["!pip install datasets evaluate transformers[sentencepiece]\n","!pip install accelerate\n","# To run the training on TPU, you will need to uncomment the following line:\n","# !pip install cloud-tpu-client==0.10 torch==1.9.0 https://storage.googleapis.com/tpu-pytorch/wheels/torch_xla-1.9-cp37-cp37m-linux_x86_64.whl\n","!apt install git-lfs"]},{"cell_type":"markdown","source":["code ini saya gunakan agar dapat merunning codenya. Kode ini menginstal library dan alat penting untuk proyek NLP (Natural Language Processing) menggunakan Hugging Face. Library yang diinstal mencakup datasets untuk memuat dan memproses dataset, evaluate untuk mengevaluasi performa model, dan transformers untuk bekerja dengan model NLP canggih. accelerate digunakan untuk mempercepat pelatihan model, baik pada GPU maupun TPU. Selain itu, Git LFS diinstal untuk mengelola file besar seperti model atau dataset saat menggunakan Hugging Face Hub. Kode ini juga menyediakan opsi tambahan untuk mengonfigurasi pelatihan pada TPU."],"metadata":{"id":"NU3XqvgoinC8"}},{"cell_type":"code","execution_count":2,"metadata":{"id":"8wh0E6E-if-n","executionInfo":{"status":"ok","timestamp":1735998090485,"user_tz":-420,"elapsed":270,"user":{"displayName":"M.Rizky Fadillah","userId":"02911994023466566780"}}},"outputs":[],"source":["!git config --global user.email \"you@example.com\"\n","!git config --global user.name \"Your Name\""]},{"cell_type":"markdown","source":["Kode ini digunakan untuk mengatur konfigurasi global Git dengan menetapkan email dan nama pengguna. Konfigurasi ini memastikan setiap kontribusi pada repositori Git memiliki identitas yang jelas, memudahkan pelacakan perubahan, dan menjaga keterhubungan dengan platform pengelolaan versi seperti GitHub atau GitLab."],"metadata":{"id":"zjP0qQFIitVl"}},{"cell_type":"code","execution_count":3,"metadata":{"id":"j871rlCHif-n","colab":{"base_uri":"https://localhost:8080/","height":17,"referenced_widgets":["1c2fef7d254449f0a72f21452aaa125b","b996c0398e784c96b9ecbb95c41eb43d","9e56806efe084f1abd38ac0df1cba591","95b1d7b46b3f4e82bdbb89f3cf6a28d2","c9fa2fe38cbc4d489b61022750d0b853","cf2c469d79ad403bbe2c25986aec1b2c","648e0bc5dd1445debe009f809dee64ee","b72f4d9f7c114b10bfcb6b81756d5139","0ff36ec322544b60ab0ee72bd8f26a30","bf4ded91c5054f14b66add47bbb90753","f0567695c8914446ba85a47aa1619ca3","2f41ae52b9c44123b57c37a240d695f6","ea631761a9614f4aab26923fe9c83681","d7a2755d1b8546488b68701c3041bc2d","3de100e7d3c34cd9b5eace788d9cfca6","00bcbeb251ce494cb86e9d8e0a2d5a33","40e736f44cc54f1081ae3c57e93b6806","9dba1a68f0874701b8751155f0288b9a","064dbc7b8ead4426af1f9e8ab86aac92","082bb0079ad24bbeb01dd964f20cec6b"]},"executionInfo":{"status":"ok","timestamp":1735998108217,"user_tz":-420,"elapsed":691,"user":{"displayName":"M.Rizky Fadillah","userId":"02911994023466566780"}},"outputId":"f5af25c3-cc6a-443f-9bbb-5841aacd336d"},"outputs":[{"output_type":"display_data","data":{"text/plain":["VBox(children=(HTML(value='<center> <img\\nsrc=https://huggingface.co/front/assets/huggingface_logo-noborder.sv…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1c2fef7d254449f0a72f21452aaa125b"}},"metadata":{}}],"source":["from huggingface_hub import notebook_login\n","\n","notebook_login()"]},{"cell_type":"markdown","source":["Kode ini digunakan untuk autentikasi ke Hugging Face Hub melalui notebook. Dengan menjalankan notebook_login(), pengguna dapat memasukkan token akses mereka untuk mendapatkan izin mengelola model, dataset, dan sumber daya lain di Hugging Face Hub secara langsung dari lingkungan notebook, sehingga mempermudah integrasi dan kolaborasi dalam proyek NLP."],"metadata":{"id":"bRz8INYhixoD"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"2Xt3s1p4if-o"},"outputs":[],"source":["from datasets import load_dataset\n","\n","raw_datasets = load_dataset(\"kde4\", lang1=\"en\", lang2=\"fr\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AdVCfDhxif-o","outputId":"ab05d50b-866b-4e9d-aa4c-87c51fc343bf"},"outputs":[{"data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['id', 'translation'],\n","        num_rows: 210173\n","    })\n","})"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["raw_datasets"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"M83zyFBbif-o","outputId":"5b582b5d-c280-477a-88f0-af79e9cf3be9"},"outputs":[{"data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['id', 'translation'],\n","        num_rows: 189155\n","    })\n","    test: Dataset({\n","        features: ['id', 'translation'],\n","        num_rows: 21018\n","    })\n","})"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["split_datasets = raw_datasets[\"train\"].train_test_split(train_size=0.9, seed=20)\n","split_datasets"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ZoigBDNWif-o"},"outputs":[],"source":["split_datasets[\"validation\"] = split_datasets.pop(\"test\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"GkEbpAaJif-p","outputId":"c3e8df97-d1fd-47a7-d979-8714fecbac7d"},"outputs":[{"data":{"text/plain":["{'en': 'Default to expanded threads',\n"," 'fr': 'Par défaut, développer les fils de discussion'}"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["split_datasets[\"train\"][1][\"translation\"]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WMMVOF4gif-p","outputId":"a84301df-84d6-4463-cc27-f87b8dcdfe06"},"outputs":[{"data":{"text/plain":["[{'translation_text': 'Par défaut pour les threads élargis'}]"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["from transformers import pipeline\n","\n","model_checkpoint = \"Helsinki-NLP/opus-mt-en-fr\"\n","translator = pipeline(\"translation\", model=model_checkpoint)\n","translator(\"Default to expanded threads\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"eCTYH7yUif-p","outputId":"59ef058b-5483-4189-818b-2715175074f7"},"outputs":[{"data":{"text/plain":["{'en': 'Unable to import %1 using the OFX importer plugin. This file is not the correct format.',\n"," 'fr': \"Impossible d'importer %1 en utilisant le module d'extension d'importation OFX. Ce fichier n'a pas un format correct.\"}"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["split_datasets[\"train\"][172][\"translation\"]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tIGoB10zif-p","outputId":"1d89fa9e-4d77-4d48-a3b0-7859a8dc34df"},"outputs":[{"data":{"text/plain":["[{'translation_text': \"Impossible d'importer %1 en utilisant le plugin d'importateur OFX. Ce fichier n'est pas le bon format.\"}]"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["translator(\n","    \"Unable to import %1 using the OFX importer plugin. This file is not the correct format.\"\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PYkixIwjif-p"},"outputs":[],"source":["from transformers import AutoTokenizer\n","\n","model_checkpoint = \"Helsinki-NLP/opus-mt-en-fr\"\n","tokenizer = AutoTokenizer.from_pretrained(model_checkpoint, return_tensors=\"pt\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e1H6nW5cif-q","outputId":"b5dbd1c9-e47d-4f57-f202-bff03b120f99"},"outputs":[{"data":{"text/plain":["{'input_ids': [47591, 12, 9842, 19634, 9, 0], 'attention_mask': [1, 1, 1, 1, 1, 1], 'labels': [577, 5891, 2, 3184, 16, 2542, 5, 1710, 0]}"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["en_sentence = split_datasets[\"train\"][1][\"translation\"][\"en\"]\n","fr_sentence = split_datasets[\"train\"][1][\"translation\"][\"fr\"]\n","\n","inputs = tokenizer(en_sentence, text_target=fr_sentence)\n","inputs"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6d5QBnZmif-q","outputId":"a336b395-415a-4e92-bd35-88e1bb08392a"},"outputs":[{"data":{"text/plain":["['▁Par', '▁dé', 'f', 'aut', ',', '▁dé', 've', 'lop', 'per', '▁les', '▁fil', 's', '▁de', '▁discussion', '</s>']\n","['▁Par', '▁défaut', ',', '▁développer', '▁les', '▁fils', '▁de', '▁discussion', '</s>']"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["wrong_targets = tokenizer(fr_sentence)\n","print(tokenizer.convert_ids_to_tokens(wrong_targets[\"input_ids\"]))\n","print(tokenizer.convert_ids_to_tokens(inputs[\"labels\"]))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"J3ajGyTVif-q"},"outputs":[],"source":["max_length = 128\n","\n","\n","def preprocess_function(examples):\n","    inputs = [ex[\"en\"] for ex in examples[\"translation\"]]\n","    targets = [ex[\"fr\"] for ex in examples[\"translation\"]]\n","    model_inputs = tokenizer(\n","        inputs, text_target=targets, max_length=max_length, truncation=True\n","    )\n","    return model_inputs"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xGgtuu7fif-q"},"outputs":[],"source":["tokenized_datasets = split_datasets.map(\n","    preprocess_function,\n","    batched=True,\n","    remove_columns=split_datasets[\"train\"].column_names,\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BTA0sNNeif-q"},"outputs":[],"source":["from transformers import AutoModelForSeq2SeqLM\n","\n","model = AutoModelForSeq2SeqLM.from_pretrained(model_checkpoint)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ac_xTwXYif-r"},"outputs":[],"source":["from transformers import DataCollatorForSeq2Seq\n","\n","data_collator = DataCollatorForSeq2Seq(tokenizer, model=model)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ItcCCI_iif-r","outputId":"7a48fdb2-6cca-47c8-fa72-15278573c073"},"outputs":[{"data":{"text/plain":["dict_keys(['attention_mask', 'input_ids', 'labels', 'decoder_input_ids'])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["batch = data_collator([tokenized_datasets[\"train\"][i] for i in range(1, 3)])\n","batch.keys()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a4jQj78Iif-r","outputId":"e60576f4-3a12-4516-c1d8-b2b958437892"},"outputs":[{"data":{"text/plain":["tensor([[  577,  5891,     2,  3184,    16,  2542,     5,  1710,     0,  -100,\n","          -100,  -100,  -100,  -100,  -100,  -100],\n","        [ 1211,     3,    49,  9409,  1211,     3, 29140,   817,  3124,   817,\n","           550,  7032,  5821,  7907, 12649,     0]])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["batch[\"labels\"]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Qy5J4QIoif-r","outputId":"0ce5f0ac-b130-42ec-fd8c-d14a4e6dc346"},"outputs":[{"data":{"text/plain":["tensor([[59513,   577,  5891,     2,  3184,    16,  2542,     5,  1710,     0,\n","         59513, 59513, 59513, 59513, 59513, 59513],\n","        [59513,  1211,     3,    49,  9409,  1211,     3, 29140,   817,  3124,\n","           817,   550,  7032,  5821,  7907, 12649]])"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["batch[\"decoder_input_ids\"]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zosTlK7_if-r","outputId":"ae36955c-ef55-4a5f-c322-1c0c3f923b28"},"outputs":[{"data":{"text/plain":["[577, 5891, 2, 3184, 16, 2542, 5, 1710, 0]\n","[1211, 3, 49, 9409, 1211, 3, 29140, 817, 3124, 817, 550, 7032, 5821, 7907, 12649, 0]"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["for i in range(1, 3):\n","    print(tokenized_datasets[\"train\"][i][\"labels\"])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"h_EguJDeif-r"},"outputs":[],"source":["!pip install sacrebleu"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DWqbsAvTif-r"},"outputs":[],"source":["import evaluate\n","\n","metric = evaluate.load(\"sacrebleu\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DIARJJa2if-r","outputId":"4488b12c-c067-43c2-9633-6a18bfa8d5fa"},"outputs":[{"data":{"text/plain":["{'score': 46.750469682990165,\n"," 'counts': [11, 6, 4, 3],\n"," 'totals': [12, 11, 10, 9],\n"," 'precisions': [91.67, 54.54, 40.0, 33.33],\n"," 'bp': 0.9200444146293233,\n"," 'sys_len': 12,\n"," 'ref_len': 13}"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["predictions = [\n","    \"This plugin lets you translate web pages between several languages automatically.\"\n","]\n","references = [\n","    [\n","        \"This plugin allows you to automatically translate web pages between several languages.\"\n","    ]\n","]\n","metric.compute(predictions=predictions, references=references)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rV-EH3tiif-s","outputId":"b665db6a-b660-40c4-b86a-452073487fbf"},"outputs":[{"data":{"text/plain":["{'score': 1.683602693167689,\n"," 'counts': [1, 0, 0, 0],\n"," 'totals': [4, 3, 2, 1],\n"," 'precisions': [25.0, 16.67, 12.5, 12.5],\n"," 'bp': 0.10539922456186433,\n"," 'sys_len': 4,\n"," 'ref_len': 13}"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["predictions = [\"This This This This\"]\n","references = [\n","    [\n","        \"This plugin allows you to automatically translate web pages between several languages.\"\n","    ]\n","]\n","metric.compute(predictions=predictions, references=references)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qaU-7rQaif-s","outputId":"02eb8ed9-72d0-452a-c1b0-a2dc392a4a87"},"outputs":[{"data":{"text/plain":["{'score': 0.0,\n"," 'counts': [2, 1, 0, 0],\n"," 'totals': [2, 1, 0, 0],\n"," 'precisions': [100.0, 100.0, 0.0, 0.0],\n"," 'bp': 0.004086771438464067,\n"," 'sys_len': 2,\n"," 'ref_len': 13}"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["predictions = [\"This plugin\"]\n","references = [\n","    [\n","        \"This plugin allows you to automatically translate web pages between several languages.\"\n","    ]\n","]\n","metric.compute(predictions=predictions, references=references)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"CX2YbibMif-s"},"outputs":[],"source":["import numpy as np\n","\n","\n","def compute_metrics(eval_preds):\n","    preds, labels = eval_preds\n","    # In case the model returns more than the prediction logits\n","    if isinstance(preds, tuple):\n","        preds = preds[0]\n","\n","    decoded_preds = tokenizer.batch_decode(preds, skip_special_tokens=True)\n","\n","    # Replace -100s in the labels as we can't decode them\n","    labels = np.where(labels != -100, labels, tokenizer.pad_token_id)\n","    decoded_labels = tokenizer.batch_decode(labels, skip_special_tokens=True)\n","\n","    # Some simple post-processing\n","    decoded_preds = [pred.strip() for pred in decoded_preds]\n","    decoded_labels = [[label.strip()] for label in decoded_labels]\n","\n","    result = metric.compute(predictions=decoded_preds, references=decoded_labels)\n","    return {\"bleu\": result[\"score\"]}"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p3dopRHAif-s"},"outputs":[],"source":["from huggingface_hub import notebook_login\n","\n","notebook_login()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iiXy5UOSif-t"},"outputs":[],"source":["from transformers import Seq2SeqTrainingArguments\n","\n","args = Seq2SeqTrainingArguments(\n","    f\"marian-finetuned-kde4-en-to-fr\",\n","    evaluation_strategy=\"no\",\n","    save_strategy=\"epoch\",\n","    learning_rate=2e-5,\n","    per_device_train_batch_size=32,\n","    per_device_eval_batch_size=64,\n","    weight_decay=0.01,\n","    save_total_limit=3,\n","    num_train_epochs=3,\n","    predict_with_generate=True,\n","    fp16=True,\n","    push_to_hub=True,\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"vMBP8hY6if-t"},"outputs":[],"source":["from transformers import Seq2SeqTrainer\n","\n","trainer = Seq2SeqTrainer(\n","    model,\n","    args,\n","    train_dataset=tokenized_datasets[\"train\"],\n","    eval_dataset=tokenized_datasets[\"validation\"],\n","    data_collator=data_collator,\n","    tokenizer=tokenizer,\n","    compute_metrics=compute_metrics,\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f7Trlmbtif-t","outputId":"7f2c0639-8e0e-4dba-817c-bb3e8afad989"},"outputs":[{"data":{"text/plain":["{'eval_loss': 1.6964408159255981,\n"," 'eval_bleu': 39.26865061007616,\n"," 'eval_runtime': 965.8884,\n"," 'eval_samples_per_second': 21.76,\n"," 'eval_steps_per_second': 0.341}"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["trainer.evaluate(max_length=max_length)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"931RNL7Sif-u"},"outputs":[],"source":["trainer.train()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X7UXxMfHif-u","outputId":"a7b15e70-82db-46c0-f80d-019a18cbf938"},"outputs":[{"data":{"text/plain":["{'eval_loss': 0.8558505773544312,\n"," 'eval_bleu': 52.94161337775576,\n"," 'eval_runtime': 714.2576,\n"," 'eval_samples_per_second': 29.426,\n"," 'eval_steps_per_second': 0.461,\n"," 'epoch': 3.0}"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["trainer.evaluate(max_length=max_length)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YAwgufuFif-u","outputId":"fef177de-2368-4684-a045-70c2d2771909"},"outputs":[{"data":{"text/plain":["'https://huggingface.co/sgugger/marian-finetuned-kde4-en-to-fr/commit/3601d621e3baae2bc63d3311452535f8f58f6ef3'"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["trainer.push_to_hub(tags=\"translation\", commit_message=\"Training complete\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XpPwEKMfif-v"},"outputs":[],"source":["from torch.utils.data import DataLoader\n","\n","tokenized_datasets.set_format(\"torch\")\n","train_dataloader = DataLoader(\n","    tokenized_datasets[\"train\"],\n","    shuffle=True,\n","    collate_fn=data_collator,\n","    batch_size=8,\n",")\n","eval_dataloader = DataLoader(\n","    tokenized_datasets[\"validation\"], collate_fn=data_collator, batch_size=8\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3_jaQ8wCif-v"},"outputs":[],"source":["model = AutoModelForSeq2SeqLM.from_pretrained(model_checkpoint)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oIymPifwif-v"},"outputs":[],"source":["from transformers import AdamW\n","\n","optimizer = AdamW(model.parameters(), lr=2e-5)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3mohGuXnif-w"},"outputs":[],"source":["from accelerate import Accelerator\n","\n","accelerator = Accelerator()\n","model, optimizer, train_dataloader, eval_dataloader = accelerator.prepare(\n","    model, optimizer, train_dataloader, eval_dataloader\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zoO6r1-5if-w"},"outputs":[],"source":["from transformers import get_scheduler\n","\n","num_train_epochs = 3\n","num_update_steps_per_epoch = len(train_dataloader)\n","num_training_steps = num_train_epochs * num_update_steps_per_epoch\n","\n","lr_scheduler = get_scheduler(\n","    \"linear\",\n","    optimizer=optimizer,\n","    num_warmup_steps=0,\n","    num_training_steps=num_training_steps,\n",")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-5DEvOTRif-w","outputId":"4445e685-f9b3-4c43-b8f9-2f3c5d128715"},"outputs":[{"data":{"text/plain":["'sgugger/marian-finetuned-kde4-en-to-fr-accelerate'"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["from huggingface_hub import Repository, get_full_repo_name\n","\n","model_name = \"marian-finetuned-kde4-en-to-fr-accelerate\"\n","repo_name = get_full_repo_name(model_name)\n","repo_name"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_fs2WyKWif-x"},"outputs":[],"source":["output_dir = \"marian-finetuned-kde4-en-to-fr-accelerate\"\n","repo = Repository(output_dir, clone_from=repo_name)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"w8gHR6Ysif-x"},"outputs":[],"source":["def postprocess(predictions, labels):\n","    predictions = predictions.cpu().numpy()\n","    labels = labels.cpu().numpy()\n","\n","    decoded_preds = tokenizer.batch_decode(predictions, skip_special_tokens=True)\n","\n","    # Replace -100 in the labels as we can't decode them.\n","    labels = np.where(labels != -100, labels, tokenizer.pad_token_id)\n","    decoded_labels = tokenizer.batch_decode(labels, skip_special_tokens=True)\n","\n","    # Some simple post-processing\n","    decoded_preds = [pred.strip() for pred in decoded_preds]\n","    decoded_labels = [[label.strip()] for label in decoded_labels]\n","    return decoded_preds, decoded_labels"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ayp3_btaif-x","outputId":"d236595f-f846-4a49-8e6d-0a4bb4572e5a"},"outputs":[{"data":{"text/plain":["epoch 0, BLEU score: 53.47\n","epoch 1, BLEU score: 54.24\n","epoch 2, BLEU score: 54.44"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["from tqdm.auto import tqdm\n","import torch\n","\n","progress_bar = tqdm(range(num_training_steps))\n","\n","for epoch in range(num_train_epochs):\n","    # Training\n","    model.train()\n","    for batch in train_dataloader:\n","        outputs = model(**batch)\n","        loss = outputs.loss\n","        accelerator.backward(loss)\n","\n","        optimizer.step()\n","        lr_scheduler.step()\n","        optimizer.zero_grad()\n","        progress_bar.update(1)\n","\n","    # Evaluation\n","    model.eval()\n","    for batch in tqdm(eval_dataloader):\n","        with torch.no_grad():\n","            generated_tokens = accelerator.unwrap_model(model).generate(\n","                batch[\"input_ids\"],\n","                attention_mask=batch[\"attention_mask\"],\n","                max_length=128,\n","            )\n","        labels = batch[\"labels\"]\n","\n","        # Necessary to pad predictions and labels for being gathered\n","        generated_tokens = accelerator.pad_across_processes(\n","            generated_tokens, dim=1, pad_index=tokenizer.pad_token_id\n","        )\n","        labels = accelerator.pad_across_processes(labels, dim=1, pad_index=-100)\n","\n","        predictions_gathered = accelerator.gather(generated_tokens)\n","        labels_gathered = accelerator.gather(labels)\n","\n","        decoded_preds, decoded_labels = postprocess(predictions_gathered, labels_gathered)\n","        metric.add_batch(predictions=decoded_preds, references=decoded_labels)\n","\n","    results = metric.compute()\n","    print(f\"epoch {epoch}, BLEU score: {results['score']:.2f}\")\n","\n","    # Save and upload\n","    accelerator.wait_for_everyone()\n","    unwrapped_model = accelerator.unwrap_model(model)\n","    unwrapped_model.save_pretrained(output_dir, save_function=accelerator.save)\n","    if accelerator.is_main_process:\n","        tokenizer.save_pretrained(output_dir)\n","        repo.push_to_hub(\n","            commit_message=f\"Training in progress epoch {epoch}\", blocking=False\n","        )"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MG6-vBUpif-x","outputId":"019c6344-bf25-4f95-e30b-7be6d7dbd76c"},"outputs":[{"data":{"text/plain":["[{'translation_text': 'Par défaut, développer les fils de discussion'}]"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["from transformers import pipeline\n","\n","# Replace this with your own checkpoint\n","model_checkpoint = \"huggingface-course/marian-finetuned-kde4-en-to-fr\"\n","translator = pipeline(\"translation\", model=model_checkpoint)\n","translator(\"Default to expanded threads\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Aq17TKmNif-x","outputId":"2461c811-9c20-4e04-a144-5eb9f9047159"},"outputs":[{"data":{"text/plain":["[{'translation_text': \"Impossible d'importer %1 en utilisant le module externe d'importation OFX. Ce fichier n'est pas le bon format.\"}]"]},"execution_count":null,"metadata":{},"output_type":"execute_result"}],"source":["translator(\n","    \"Unable to import %1 using the OFX importer plugin. This file is not the correct format.\"\n",")"]}],"metadata":{"colab":{"provenance":[{"file_id":"https://github.com/huggingface/notebooks/blob/master/course/en/chapter7/section4_pt.ipynb","timestamp":1735997920278}]},"language_info":{"name":"python"},"kernelspec":{"name":"python3","display_name":"Python 3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"1c2fef7d254449f0a72f21452aaa125b":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":[],"layout":"IPY_MODEL_648e0bc5dd1445debe009f809dee64ee"}},"b996c0398e784c96b9ecbb95c41eb43d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b72f4d9f7c114b10bfcb6b81756d5139","placeholder":"​","style":"IPY_MODEL_0ff36ec322544b60ab0ee72bd8f26a30","value":"<center> <img\nsrc=https://huggingface.co/front/assets/huggingface_logo-noborder.svg\nalt='Hugging Face'> <br> Copy a token from <a\nhref=\"https://huggingface.co/settings/tokens\" target=\"_blank\">your Hugging Face\ntokens page</a> and paste it below. <br> Immediately click login after copying\nyour token or it might be stored in plain text in this notebook file. </center>"}},"9e56806efe084f1abd38ac0df1cba591":{"model_module":"@jupyter-widgets/controls","model_name":"PasswordModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"PasswordModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"PasswordView","continuous_update":true,"description":"Token:","description_tooltip":null,"disabled":false,"layout":"IPY_MODEL_bf4ded91c5054f14b66add47bbb90753","placeholder":"​","style":"IPY_MODEL_f0567695c8914446ba85a47aa1619ca3","value":""}},"95b1d7b46b3f4e82bdbb89f3cf6a28d2":{"model_module":"@jupyter-widgets/controls","model_name":"CheckboxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"CheckboxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"CheckboxView","description":"Add token as git credential?","description_tooltip":null,"disabled":false,"indent":true,"layout":"IPY_MODEL_2f41ae52b9c44123b57c37a240d695f6","style":"IPY_MODEL_ea631761a9614f4aab26923fe9c83681","value":true}},"c9fa2fe38cbc4d489b61022750d0b853":{"model_module":"@jupyter-widgets/controls","model_name":"ButtonModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ButtonModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ButtonView","button_style":"","description":"Login","disabled":false,"icon":"","layout":"IPY_MODEL_d7a2755d1b8546488b68701c3041bc2d","style":"IPY_MODEL_3de100e7d3c34cd9b5eace788d9cfca6","tooltip":""}},"cf2c469d79ad403bbe2c25986aec1b2c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_00bcbeb251ce494cb86e9d8e0a2d5a33","placeholder":"​","style":"IPY_MODEL_40e736f44cc54f1081ae3c57e93b6806","value":"\n<b>Pro Tip:</b> If you don't already have one, you can create a dedicated\n'notebooks' token with 'write' access, that you can then easily reuse for all\nnotebooks. </center>"}},"648e0bc5dd1445debe009f809dee64ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":"center","align_self":null,"border":null,"bottom":null,"display":"flex","flex":null,"flex_flow":"column","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"50%"}},"b72f4d9f7c114b10bfcb6b81756d5139":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ff36ec322544b60ab0ee72bd8f26a30":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bf4ded91c5054f14b66add47bbb90753":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f0567695c8914446ba85a47aa1619ca3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2f41ae52b9c44123b57c37a240d695f6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ea631761a9614f4aab26923fe9c83681":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d7a2755d1b8546488b68701c3041bc2d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3de100e7d3c34cd9b5eace788d9cfca6":{"model_module":"@jupyter-widgets/controls","model_name":"ButtonStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ButtonStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","button_color":null,"font_weight":""}},"00bcbeb251ce494cb86e9d8e0a2d5a33":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"40e736f44cc54f1081ae3c57e93b6806":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9dba1a68f0874701b8751155f0288b9a":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_064dbc7b8ead4426af1f9e8ab86aac92","placeholder":"​","style":"IPY_MODEL_082bb0079ad24bbeb01dd964f20cec6b","value":"Connecting..."}},"064dbc7b8ead4426af1f9e8ab86aac92":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"082bb0079ad24bbeb01dd964f20cec6b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}